<?xml version="1.0"?>
<package xmlns="http://schemas.microsoft.com/packaging/2011/10/nuspec.xsd">
  <metadata>
    <id>PowerShell</id>
    <version>5.1.14409.20170301</version>
    <title>Windows Management Framework and PowerShell</title>
    <authors>Microsoft wrote PowerShell, IntelliTect created the Chocolatey Package</authors>
    <owners>Mark Michaelis, Darwin Sanoy (CSI-Windows.com)</owners>
    <licenseUrl>https://raw.githubusercontent.com/IntelliTect/Licenses/master/WindowsManagementFramework.txt</licenseUrl>
    <projectUrl>http://blogs.msdn.com/b/powershell/archive/2015/12/16/windows-management-framework-wmf-5-0-rtm-is-now-available.aspx</projectUrl>
    <iconUrl>http://www.rssbus.com/ui/img/logo-powershell.png</iconUrl>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>Windows Management Framework 5.0 includes updates to Windows PowerShell, Windows PowerShell ISE, Windows PowerShell Web Services (Management OData IIS Extension), Windows Remote Management (WinRM), Windows Management Instrumentation (WMI), the Server Manager WMI provider, and a new feature for 4.0, Windows PowerShell Desired State Configuration (DSC).
    Windows Management Framework 5.0 includes updates to Windows PowerShell, Windows PowerShell Desired State Configuration (DSC), and Windows PowerShell ISE. It also includes OneGet, PowerShellGet, and Network Switch cmdlets

     Important Product Incompatibility Notes: https://msdn.microsoft.com/en-us/powershell/wmf/5.0/productincompat

        IMPORTANT NOTES for your Operating System:

		    PowerShell 4 and later requires at least .NET 3.5.1.
			This package will warn you and exit if it is not installed.
			It is not automatically installed as a dependency so that you
			maintain complete control over the .NET version in your build.

            Windows 8.1, Windows 2012R2: Installs PowerShell 5.0.
            Windows 8: PowerShell 4.0 not supported.  PowerShell 3.0 installed by default
            Windows 7 SP1, Windows 2008 R2 SP1, or Windows 2012: PowerShell 5.0 installed (as of 5.0.10105 April 2015 Preview)
			   ATTENTION: Windows 7 and Server 2008 R2 Required WMF/PowerShell 4.0 to be installed first.
			     This package will install 4 if it is not installed and instruct you to re-run the package using -Force
				 Or you can just install WMF 4 first if you have this already setup in build automation.
				 This is a temporary restriction that Microsoft is working on removing for the final release.
            Windows Vista or Windows 2008: Directs to PowerShell 3.0 install
			WARNING: DO NOT INSTALL ON SCCM SERVERS.
			Tested On: Windows 7, Windows 8.1, Windows 2008 R2, Windows 2012, Windows 2012 R2, Windows 10</description>
    <summary>Installs Windows Management Framework (with PowerShell) 5.0, Windows Management Framework 4.0 (with PowerShell) 4.0 or PowerShell 3.0 (if 'legacy' OS.)</summary>
    <releaseNotes>

      WMF 5.1 Release Notes: https://msdn.microsoft.com/en-us/powershell/wmf/5.1/release-notes

     2017.02.14 
       WMF Version: 5.1.14409.1005
       Pkg Version: 5.1.14409.20170301
       - fixed bug misidentifying the .net version on Server 2012

     2017.02.14 
       WMF Version: 5.1.14409.1005
       Pkg Version: 5.1.14409.20170214
       - fixed bug causing Server 2012 (non-R2) from being detected as windows 8

      2017.01.26  (5.1.14409.1005)
        -  New: Installs WMF 5.1
        -  Tested On: Win7 + PSH 2, Win7 + WMF 3, Win 8.1 + WMF 4, 2012 R2 + WMF 5.0, Windows 10
        -  EXPERIMENTAL: Attempts to Preserve the PSModulePath when WMF 5.1 is 
                         installed over WMF 3 on Windows 7 or Server 2008.

             How the experimental support works:
               *) It only takes effect on Windows 7 and Server 2008 R2 and only if WMF 3 is installed
               *) You must pre-install at least .NET 4.5.1 (required by WMF 4 and later)
               *) You must use the -force switch on the package

               What steps are taken to preserve PSModulePath:
                  1) The custom parts of the PSModulePath backed up to BackupPSModulePath
                  2) A fix up script that appends those values to the PSModulePath is written to:
                           %WINDIR%\Temp\psmodulepathfixup.ps1
                  3) A scheduled task is setup for the next reboot that runs the fix up script

               If you find that #3 does not work correctly, then you can use #1 or #2 with some of your 
               own automation to recover from the PsModulePath overwrite.

      2016.12.01  (5.0.10586.20170115)
        -  Fixed: Package generates error that you must upgrade to Windows 8.1 on Server 2012 (not-R2) domain controllers.

      2016.12.01  (5.0.10586.20161201)
        -  IMPORTANT: This package no longer updates a machine to an older version of PowerShell when 5 cannot be applied, the package must
             be explicitly called with the -version parameter if the system being configured cannot take PowerShell 5.
        -  Updated to use checksums
        -  Updated to use re-released MSUs discussed here (old ones getting 404s):
             https://blogs.msdn.microsoft.com/powershell/2016/02/24/windows-management-framework-wmf-5-0-rtm-packages-has-been-republished/
        -  Checks and errors if Windows Update service is disabled, the error message suggests enabling it just for the time this package runs
             (it is a common good practice to disable Windows Update when doing long running orchestration,
             however, it must be enabled for this package to run)

	    2016.3.28:
				Fixed bug with Windows Server 2012 installation

			2015.12.19:
        Updated for PowerShell 5.0.10586.20151218 RTM - Released 2015-12-18.

      2015.09.02:
        Updated for PowerShell 5.0.10514.6 (Production Preview) Released 8/31/15 (Darwin).
				Checks if you already have 5.0 installed and requires previous versions of 5 to be uninstalled first.

			2015.04.29:
        Updated for PowerShell 5.0.10105 (April 2015 Preview) (Darwin).
				Windows 7 SP1 and Server 2008 R2 SP1 NOW SUPPORTED FOR PSH 5!

      2015.03.18:
        Updated for PowerShell 5 (Darwin).

			2014.10.01:
        Changed to report success when PowerShell 4.0 is already installed.

      2014.09.15:
        Support added for PowerShell 4.0
    </releaseNotes>
    <copyright>2013 Microsoft Corporation</copyright>
    <tags>PowerShell admin Reboot Scripting OneGet</tags>
  </metadata>
</package>
